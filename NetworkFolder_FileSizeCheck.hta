<html>
<head>
<title>Vbscript File Size Check</title>


<HTA:APPLICATION 
     ID="FileSizerCLI"
     APPLICATIONNAME="FileSizingIT"
     SCROLL="yes"
     SINGLEINSTANCE="yes"
	maximizeButton="no" 
	minimizeButton="yes" 
	showInTaskbar="yes" 
	caption = "no"
	BORDERSTYLE="raised"
	BORDER="thick" 
</head>

<SCRIPT Language="VBScript">
Public resultName

Sub Window_Onload
	self.Focus()
	self.ResizeTo 600,550
End Sub

Sub RunReload
    Location.Reload(True)
End Sub

Function LogOff()
	window.close
End Function

Function resultNameNow ()
	dim m
	set m = new filingName
	If Len (month(now)) < 2 Then
		monthly = "0" & (month(now))
	Else
		monthly = (month(now))
	End If

	If Len (day(now)) < 2 Then
		dayly = "0" & (day(now))
	Else
		dayly = (day(now))
	End If

	If Len (hour(now)) < 2 Then
		hourly = "0" & (hour(now))
	Else
		hourly = (hour(now))
	End If

	If Len (minute(now)) < 2 Then
		minutely = "0" & (minute(now))
	Else
		minutely = (minute(now))
	End If

	If Len (second(now)) < 2 Then
		secondly = "0" & (second(now))
	Else
		secondly = (second(now))
	End If
	m.name = "FileSizeChecker_" & year(now) & monthly & dayly & "_" & hourly & minutely & secondly
	set resultNameNow = m
End Function

Sub MainSub
	Set m = resultNameNow()
	resultName = m.name
	sTxtarea = TextAreaPcName.value
	PcName = Split (sTxtarea,vbCRLF)
	strDriveLetter = localVariables.strDriveLetter.value
	strUser = localVariables.strUser.value
	strPassword = localVariables.strPassword.value
	remotefolder = localVariables.remotefolder.value
	Const strProfile = "false"
	
	'ON ERROR RESUME NEXT
	Const ForReading = 1
	Const ForWriting = 2
	Const ForAppending = 8

	Dim objNetwork
	Dim objFSO
	Dim objShell
	Dim strLine1, strLine
	Set objNetwork = WScript.CreateObject("WScript.Network")
	Set objFSO = CreateObject("Scripting.FileSystemObject")
	Set objShell = WScript.CreateObject("WScript.Shell") 	
		For Each Item In PcName	
			strRemotePath = "\\"&Item&"\c$" 
			Set AllDrives = objNetwork.EnumNetworkDrives() 
			AlreadyConnected = False 
			For i = 0 To AllDrives.Count - 1 Step 2 
				If AllDrives.Item(i) = strDriveLetter Then AlreadyConnected = True 
			Next 
			If AlreadyConnected = True then 
				objNetwork.RemoveNetworkDrive strDriveLetter
				objNetwork.MapNetworkDrive strDriveLetter, strRemotePath, strProfile, strUser, strPassword
			Else 
				objNetwork.MapNetworkDrive strDriveLetter, strRemotePath, strProfile, strUser, strPassword
			End if
			
			objPathTMP = Split (remotefolder, ":",-1,1)
			objPath = strDriveLetter & ":" & objPathTMP(1)
			Set objTextFile = objFso.OpenTextFile (resultName & ".txt", ForAppending, True,OpenAsDefault)
			objTextFile.WriteLine("File list at " & Item & " folder " & remotefolder)
			Set objFolder = objFso.GetFolder(objPath)
				For each objFile in objFolder.Files
					If objFolder.Files.Count > 0 Then
							objTextFile.WriteLine(objFile.Name & "," & objFile.Size)						
					End If				
				Next
			objTextFile.close	

			Set AllDrives = objNetwork.EnumNetworkDrives() 
			AlreadyConnected = False 
			For i = 0 To AllDrives.Count - 1 Step 2 
				If AllDrives.Item(i) = strDriveLetter Then AlreadyConnected = True 
			Next 
			If AlreadyConnected = True then 
				intReturn = objShell.Popup("Releasing \\"& Item &"\c$ from " & strDriveLetter & ":Drive.", 2, "Check File Size Script", vbOKOnly)
				objNetwork.RemoveNetworkDrive strDriveLetter
				Wscript.Sleep 1000
			End if 
		Next
	Set objNetwork = Nothing
	Set objFSO = Nothing
	Set objShell = Nothing
	Set strLine1 = Nothing
	Set strLine = Nothing
End Sub

</SCRIPT>

<body>
Windows PC to check<br>
<TEXTAREA style="Height:300;Width:150;font-Size:12;font-weight:normal;TITLE=""; NAME="TextAreaPcName"; WRAP=hard>
PC-ABC
PC-DEF
PC-GHI</TEXTAREA>
<br>
<form name="localVariables">
Temporary map network drive letter 	
<select name="strDriveLetter">
<!--<option value="G:"> &nbsp G:</option>
	<option value="H:"> &nbsp H:</option>
	<option value="I:"> &nbsp I:</option>
	<option value="J:"> &nbsp J:</option>
	<option value="K:"> &nbsp K:</option>
	<option value="L:"> &nbsp L:</option>-->
	<option value="M:"> &nbsp M:</option>
	<option value="N:"> &nbsp N:</option>
	<option value="O:"> &nbsp O:</option>
	<option value="P:"> &nbsp P:</option>
	<option value="Q:"> &nbsp Q:</option>
	<option value="R:"> &nbsp R:</option>
	<option value="S:"> &nbsp S:</option>
	<option value="T:"> &nbsp T:</option>
	<option value="U:"> &nbsp U:</option>
	<option value="V:"> &nbsp V:</option>		
</select>  to local PC for checking &nbsp
<br>
Remote folder name <input type="text" name="remotefolder" size="30" value = "drive:\application\logs" > to check file sizes from.
<br>
Username  <input type="text" name="strUser" size="10" >
Password  <input type="password" name="strPassword" size="10" > 
</form>

<br>
<input type="button" style="width:100px;height:25px" value="Submit" onClick="MainSub()" title="Map folder and collect file size.">
<input type="button" style="width:100px;height:25px" value="Quit" onClick="Logoff()" title="Close this window.">
<input type="button" style="width:100px;height:25px" value="Reset" onClick="RunReload()" title="Reset this window.">
<br>

<hr></hr>
<Span Id = "DataArea"></Span>
<br>
<!-- 
EXCLUDE string<br>
<TEXTAREA style="Height:100;Width:700;font-Size:12;font-weight:normal;TITLE=""; NAME="EXCLUDING"; WRAP=hard>
exclude this string text 1
</TEXTAREA>
-->

</body>
</html>
